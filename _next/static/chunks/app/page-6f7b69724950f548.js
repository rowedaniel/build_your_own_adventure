(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5427:function(e,t,n){Promise.resolve().then(n.bind(n,2546))},2546:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var s,r,a=n(9268),i=n(6006);function o(e){let{name:t,select:n}=e;return(0,a.jsx)("div",{children:(0,a.jsxs)("button",{className:"switchStateButton",onClick:n,children:[" ",t," "]})})}(s=r||(r={}))[s.story=0]="story",s[s.tree=1]="tree";let l={data:{id:-1,text:"filler",options:[]},subbranches:{}},c="https://build-your-own-adventure-backend.fly.dev/getpart?item_id=";function d(e){let{tree:t,setTree:n,currentHistory:s,setCurrentHistory:r}=e,[o,d]=(0,i.useState)(null);function p(e,n){if(!t)return l;let s=t;for(let t of(n(s),e))n(s=s.subbranches[t]);return s}function f(e,s){if(s.child_part){d(null);let i=[...e,s.child_part],o=p(e,()=>{});if(s.child_part in o.subbranches)r(i);else{var a;let e;a=o,e=i[i.length-1],fetch(c+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.ok?e.json():l.data).then(s=>{a.subbranches[e]={data:s,subbranches:[]},n(t),r(i)})}}else r(e),d(s)}let x=[];p(s,e=>x.push(e.data));let j=x.map((e,t)=>{if(t>=s.length)return o?o.id:-1;for(let n of e.options)if(n.child_part===s[t])return n.id;return -1}),m=x.map((e,t)=>({data:e,history:s.slice(0,t),select:f,chosen:j[t]}));return(0,a.jsxs)("div",{className:"story",children:[m.map(e=>{let{data:t,history:n,select:s,chosen:r}=e;return(0,a.jsx)(h,{data:t,history:n,select:s,chosen:r},n.join("-")+"p")}),o?(0,a.jsx)(u,{option:o,create:function(e,s){fetch("https://build-your-own-adventure-backend.fly.dev/newpart",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(s=>{e.child_part=s.id,n(t),d(null)})}}):""]})}function u(e){let{option:t,create:n}=e,[s,r]=(0,i.useState)(""),[o,l]=(0,i.useState)([]);return(0,a.jsxs)("div",{className:"createPart",children:[(0,a.jsx)("h1",{children:" Create a new part! "}),(0,a.jsx)("p",{children:" You can finish the story, or leave room for someone else to extend it by adding options."}),(0,a.jsx)("span",{children:" Main Story Text: "}),(0,a.jsx)("textarea",{className:"mainText",value:s,onChange:e=>r(e.target.value)}),(0,a.jsx)("span",{children:" Options: "}),o.map((e,t)=>(0,a.jsxs)("div",{className:"optionDiv",children:[(0,a.jsx)("textarea",{className:"optionText",value:o[t].text,onChange:e=>{var n;return n=e.target.value,void l([...o.slice(0,t),{text:n},...o.slice(t+1)])}}),(0,a.jsx)("button",{className:"deleteOptionButton",onClick:()=>l([...o.slice(0,t),...o.slice(t+1)]),children:"Delete option"})]},t+"-newoption")),(0,a.jsx)("button",{className:"newOptionButton",onClick:()=>l([...o,{text:""}]),children:" New Option"}),(0,a.jsx)("button",{className:"submitButton",onClick:()=>n(t,{text:s,parent:t.id,options:o}),children:"Submit"})]})}function h(e){let{data:t,history:n,select:s,chosen:r}=e;return(0,a.jsxs)("div",{className:"part",children:[(0,a.jsxs)("div",{className:"partHeader",children:[" ",t.text," "]}),t.options.map(e=>(0,a.jsx)(p,{data:e,history:n,selected:e.id===r,select:()=>s(n,e)},n.join("-")+"p"+e.id))]})}function p(e){let{data:t,history:n,selected:s,select:r}=e;return s?(0,a.jsxs)("button",{className:"option selected",onClick:r,children:[" ",t.text," "]}):(0,a.jsxs)("button",{className:"option",onClick:r,children:[" ",t.text," "]})}function f(e){let{tree:t,setTree:n,currentHistory:s,setCurrentHistory:r}=e,i=t.data.options.map(e=>e.child_part);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"treeLayer",children:(0,a.jsx)(x,{id:t.data.id,selected:t.data.id===s[0],select:()=>r([])})}),(0,a.jsx)("div",{className:"treeLayer",children:i.map((e,i)=>e&&t.subbranches[e]?(0,a.jsx)(f,{tree:t.subbranches[e],setTree:n,currentHistory:s.slice(1),setCurrentHistory:t=>{r([e,...t])}},t.data.id+"-"+e):(0,a.jsx)(j,{},t.data.id+"-"+i+"unexplored"))})]})}function x(e){let{id:t,selected:n,select:s}=e;return n?(0,a.jsxs)("span",{className:"node selected",onClick:s,children:[" ",t," "]}):(0,a.jsxs)("span",{className:"node",onClick:s,children:[" ",t," "]})}function j(){return(0,a.jsx)("span",{className:"unexplored node",children:" ??? "})}function m(){let e,t;let[n,s]=(0,i.useState)(r.story),[u,h]=(0,i.useState)(),[p,x]=(0,i.useState)([]);if(!u)return fetch(c+1,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.ok?e.json():l.data).then(e=>{h({data:e,subbranches:[]})}),(0,a.jsx)("div",{});switch(n){case r.story:e=(0,a.jsx)(d,{tree:u,setTree:h,currentHistory:p,setCurrentHistory:x}),t={name:"tree",select:()=>s(r.tree)};break;case r.tree:e=(0,a.jsx)("div",{className:"treeContainer",children:(0,a.jsx)(f,{tree:u,setTree:h,currentHistory:[1,...p],setCurrentHistory:x})}),t={name:"story",select:()=>s(r.story)}}return(0,a.jsxs)("div",{children:[(0,a.jsx)(o,{name:t.name,select:t.select}),e]})}n(5615)},5615:function(){},3177:function(e,t,n){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=n(6006),r=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var s,l={},c=null,d=null;for(s in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,s)&&!o.hasOwnProperty(s)&&(l[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===l[s]&&(l[s]=t[s]);return{$$typeof:r,type:e,key:c,ref:d,props:l,_owner:i.current}}t.jsx=l,t.jsxs=l},9268:function(e,t,n){"use strict";e.exports=n(3177)}},function(e){e.O(0,[667,139,744],function(){return e(e.s=5427)}),_N_E=e.O()}]);